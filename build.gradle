plugins {
    id 'java'
    id 'org.springframework.boot' version '2.6.7'
    id "com.palantir.docker" version "0.33.0"
}

sourceCompatibility = JavaVersion.VERSION_17
targetCompatibility = JavaVersion.VERSION_17

group 'by.teran'
version '1.0'

repositories {
    mavenCentral()
}

dependencies {
    implementation "org.springframework.boot:spring-boot-starter-webflux:2.6.7"

    testImplementation "org.junit.jupiter:junit-jupiter-api:5.8.2"
    testImplementation 'org.mockito:mockito-junit-jupiter:4.5.1'
    testImplementation 'io.projectreactor:reactor-core:3.4.17'
    testImplementation 'io.projectreactor:reactor-test:3.4.17'
    testImplementation 'org.springframework:spring-test:5.3.19'

    testRuntimeOnly "org.junit.jupiter:junit-jupiter-engine:5.8.2"
}

test {
    useJUnitPlatform()
}

docker {
    name "teran/by.teran.transactions:$version"
    files "build/libs/transactions-${version}.jar"
    copySpec.into("build/libs")
}

task buildEverything {
    dependsOn getTasksByName("build", false)
    dependsOn getTasksByName("docker", false)
}